<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Buckshot Roulette</title>
<style>
body {
  margin: 0;
  background: #000;
  color: #eee;
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.game {
  background: #111;
  padding: 1.5rem;
  width: 460px;
  border-radius: 14px;
  box-shadow: 0 0 60px rgba(0,0,0,.9);
}
h1 { text-align: center; margin-bottom: .5rem; }
.dealer { color: #aaa; min-height: 2.5em; }
.status { min-height: 2em; margin-top: .4rem; }
button {
  background: #8b1d1d;
  border: none;
  color: white;
  padding: .5rem .8rem;
  border-radius: 6px;
  cursor: pointer;
  margin: .2rem;
}
button.secondary { background: #333; }
.inventory {
  display: grid;
  grid-template-columns: repeat(4,1fr);
  gap: .4rem;
  margin-top: .6rem;
}
.slot {
  background: #1c1c1c;
  border: 1px solid #333;
  height: 46px;
  font-size: .7rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.slot.empty { color: #444; cursor: default; }
</style>
</head>
<body>

<div class="game">
  <h1>Buckshot Roulette</h1>
  <div class="dealer" id="dealer">Dealer waits.</div>

  <div>
    <button onclick="playerFire()">Pull Trigger</button>
    <button class="secondary" onclick="reload()">Reload</button>
  </div>

  <div class="status" id="status">â€”</div>

  <h3>Inventory</h3>
  <div class="inventory" id="inventory"></div>
</div>

<script>
/* ========= STATE ========= */
let shells = [];
let liveCount = 0;
let blankCount = 0;
let playerHP = 2;
let dealerHP = 2;
let sawed = false;
let playerTurn = true;
let cuffed = { player: false, dealer: false };

let inventory = Array(8).fill(null);
let dealerInventory = [];

/* ========= ITEMS ========= */
const ITEMS = [
  { name:"Beer", use:()=>ejectShell() },
  { name:"Saw", use:()=>{ sawed=true; log("Saw applied."); } },
  { name:"Magnifier", use:()=>peekShell(0) },
  { name:"Cigarettes", use:()=>heal("player") },
  { name:"Handcuffs", use:()=>{ cuffed.dealer=true; log("Dealer cuffed."); } },
  { name:"Inverter", use:()=>invertShell() },
  { name:"Adrenaline", use:()=>stealItem() },
  { name:"Pills", use:()=>pills("player") },
  { name:"Phone", use:()=>peekFuture() }
];

/* ========= ROUND ========= */
function reload() {
  shells = [];
  sawed = false;
  cuffed = { player:false, dealer:false };

  const total = rand(2,8);
  liveCount = rand(1,total-1);
  blankCount = total-liveCount;

  for(let i=0;i<liveCount;i++) shells.push("LIVE");
  for(let i=0;i<blankCount;i++) shells.push("BLANK");
  shuffle(shells);

  document.getElementById("dealer").textContent =
    `Dealer: ${liveCount} live. ${blankCount} blank.`;

  grantItems();
  updateInventory();
  log("Shotgun loaded.");
}

/* ========= PLAYER ========= */
function playerFire() {
  if(!playerTurn) return;
  fire("dealer");
  endTurn();
}

/* ========= DEALER ========= */
function dealerTurn() {
  if(cuffed.dealer) {
    cuffed.dealer = false;
    log("Dealer skips turn.");
    playerTurn = true;
    return;
  }

  // Simple but faithful heuristics
  if(shells[0]==="BLANK" && Math.random()<0.6) {
    fire("player");
  } else {
    fire("player");
  }

  playerTurn = true;
}

/* ========= FIRE ========= */
function fire(target) {
  if(!shells.length) return log("Empty chamber.");

  const shell = shells.shift();
  if(shell==="LIVE") {
    if(sawed) {
      log("ðŸ’¥ SAWED LIVE SHELL");
      target==="player" ? playerHP-- : dealerHP--;
      sawed=false;
    } else {
      log("ðŸ’¥ LIVE SHELL");
      target==="player" ? playerHP-- : dealerHP--;
    }
  } else {
    log("clickâ€¦ BLANK");
  }

  if(!shells.length) log("Round over.");
}

/* ========= ITEMS ========= */
function ejectShell() {
  if(shells.length) {
    shells.shift();
    log("Beer ejects shell.");
  }
}
function peekShell(i) {
  if(shells[i]) log(`Peek: ${shells[i]}`);
}
function invertShell() {
  if(shells.length) {
    shells[0] = shells[0]==="LIVE"?"BLANK":"LIVE";
    log("Shell inverted.");
  }
}
function heal(who) {
  log("Healed.");
}
function pills(who) {
  Math.random()<.5 ? log("Pills healed.") : log("Pills hurt.");
}
function peekFuture() {
  const i = rand(1,Math.min(3,shells.length-1));
  if(shells[i]) log(`Future shell ${i+1}: ${shells[i]}`);
}
function stealItem() {
  if(dealerInventory.length) {
    inventory[inventory.indexOf(null)] = dealerInventory.pop();
    log("Stole item.");
  }
}

/* ========= INVENTORY ========= */
function grantItems() {
  const count = rand(1,4);
  for(let i=0;i<count;i++) {
    const item = ITEMS[rand(0,ITEMS.length-1)];
    const slot = inventory.indexOf(null);
    if(slot!==-1) inventory[slot]=item;
  }
}
function updateInventory() {
  const el = document.getElementById("inventory");
  el.innerHTML="";
  inventory.forEach((item,i)=>{
    const d=document.createElement("div");
    d.className="slot"+(item?"":" empty");
    d.textContent=item?item.name:"Empty";
    if(item) d.onclick=()=>{ item.use(); inventory[i]=null; updateInventory(); };
    el.appendChild(d);
  });
}

/* ========= FLOW ========= */
function endTurn() {
  playerTurn=false;
  setTimeout(dealerTurn,800);
}

/* ========= UTIL ========= */
function log(t){ document.getElementById("status").textContent=t; }
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}
function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a}
</script>

</body>
</html>
