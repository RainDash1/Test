<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Buckshot Roulette</title>
<style>
body {
  margin: 0;
  background: #000;
  color: #eee;
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.game {
  background: #111;
  padding: 1.5rem;
  width: 520px;
  border-radius: 14px;
  box-shadow: 0 0 60px rgba(0,0,0,.9);
}
h1 { text-align: center; margin-bottom: .4rem; }
.row { display: flex; gap: .4rem; flex-wrap: wrap; }
button {
  background: #8b1d1d;
  border: none;
  color: white;
  padding: .5rem .8rem;
  border-radius: 6px;
  cursor: pointer;
}
button.secondary { background: #333; }
button:disabled { opacity: .4; cursor: not-allowed; }
.status, .dealer { min-height: 2em; color: #aaa; }
.inventory {
  display: grid;
  grid-template-columns: repeat(4,1fr);
  gap: .4rem;
}
.slot {
  background: #1c1c1c;
  border: 1px solid #333;
  height: 42px;
  font-size: .7rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.slot.empty { color: #444; cursor: default; }
.hp { font-size: .85rem; margin-bottom: .4rem; }
</style>
</head>
<body>

<div class="game">
  <h1>Buckshot Roulette</h1>

  <div class="hp" id="hp"></div>
  <div class="dealer" id="dealer"></div>

  <div class="row">
    <button onclick="playerFire('dealer')">Fire at Dealer</button>
    <button onclick="playerFire('player')">Fire at Yourself</button>
    <button class="secondary" onclick="reload()">Reload</button>
  </div>

  <div class="status" id="status">â€”</div>

  <h3>Your Inventory</h3>
  <div class="inventory" id="playerInv"></div>

  <h3>Dealer Inventory</h3>
  <div class="inventory" id="dealerInv"></div>
</div>

<script>
/* ===== STATE ===== */
let shells=[], liveCount=0, blankCount=0;
let playerHP=2, dealerHP=2;
let sawed=false;
let playerTurn=true;
let cuffed={player:false,dealer:false};

let playerInv=Array(8).fill(null);
let dealerInv=Array(8).fill(null);

/* ===== ITEMS ===== */
const ITEMS = {
  Beer: ()=>ejectShell(),
  Saw: ()=>{ sawed=true; log("Saw armed."); },
  Magnifier: ()=>peek(0),
  Cigarettes: ()=>heal("player"),
  Handcuffs: ()=>{ cuffed.dealer=true; log("Dealer handcuffed."); },
  Inverter: ()=>invert(),
  Adrenaline: ()=>stealItem(),
  Pills: ()=>pills("player"),
  Phone: ()=>peekFuture()
};

/* ===== ROUND SETUP ===== */
function reload(){
  shells=[]; sawed=false;
  cuffed={player:false,dealer:false};

  const total=r(2,8);
  liveCount=r(1,total-1);
  blankCount=total-liveCount;

  shells.push(...Array(liveCount).fill("LIVE"));
  shells.push(...Array(blankCount).fill("BLANK"));
  shuffle(shells);

  grantItems(playerInv);
  grantItems(dealerInv);

  document.getElementById("dealer").textContent=
    `Dealer: ${liveCount} live, ${blankCount} blank.`;

  updateUI("Shotgun loaded.");
}

/* ===== FIRING ===== */
function playerFire(target){
  if(!playerTurn) return;
  fire(target);
  endPlayerTurn();
}

function fire(target){
  if(!shells.length) return updateUI("Empty chamber.");

  const shell=shells.shift();
  if(shell==="LIVE"){
    const dmg=sawed?2:1;
    if(target==="player") playerHP-=dmg;
    else dealerHP-=dmg;
    sawed=false;
    updateUI(`ðŸ’¥ LIVE SHELL (${dmg})`);
  } else {
    updateUI("clickâ€¦ BLANK");
  }
  checkDeath();
}

/* ===== DEALER TURN ===== */
function dealerTurn(){
  if(cuffed.dealer){
    cuffed.dealer=false;
    updateUI("Dealer skips turn.");
    playerTurn=true;
    return;
  }

  // crude but authentic logic
  const target = shells[0]==="LIVE" ? "player" : (Math.random()<.5?"player":"dealer");
  fire(target);
  playerTurn=true;
}

/* ===== ITEMS ===== */
function ejectShell(){
  if(shells.length){
    shells.shift();
    updateUI("Beer ejected shell.");
    endPlayerTurn();
  }
}
function peek(i){ if(shells[i]) updateUI(`Peek: ${shells[i]}`); }
function invert(){
  if(shells.length){
    shells[0]=shells[0]==="LIVE"?"BLANK":"LIVE";
    updateUI("Shell inverted.");
    endPlayerTurn();
  }
}
function heal(who){
  if(who==="player") playerHP++;
  updateUI("Healed.");
  endPlayerTurn();
}
function pills(who){
  Math.random()<.5 ? heal(who) : (who==="player"?playerHP--:dealerHP--);
  updateUI("Pills used.");
  checkDeath();
  endPlayerTurn();
}
function peekFuture(){
  const i=r(1,Math.min(3,shells.length-1));
  if(shells[i]) updateUI(`Future ${i+1}: ${shells[i]}`);
}
function stealItem(){
  const source=dealerInv.filter(Boolean);
  if(!source.length) return updateUI("Nothing to steal.");
  const item=source[r(0,source.length-1)];
  removeItem(dealerInv,item);
  addItem(playerInv,item);
  updateUI(`Stole ${item}.`);
  endPlayerTurn();
}

/* ===== INVENTORY ===== */
function grantItems(inv){
  for(let i=0;i<r(1,4);i++) addItem(inv, randomItem());
}
function addItem(inv,item){
  const i=inv.indexOf(null);
  if(i!==-1) inv[i]=item;
}
function removeItem(inv,item){
  const i=inv.indexOf(item);
  if(i!==-1) inv[i]=null;
}
function renderInv(inv,id,clickable){
  const el=document.getElementById(id);
  el.innerHTML="";
  inv.forEach((it,i)=>{
    const d=document.createElement("div");
    d.className="slot"+(it?"":" empty");
    d.textContent=it||"Empty";
    if(it&&clickable){
      d.onclick=()=>{
        ITEMS[it]();
        inv[i]=null;
        renderAll();
      };
    }
    el.appendChild(d);
  });
}

/* ===== FLOW ===== */
function endPlayerTurn(){
  playerTurn=false;
  setTimeout(dealerTurn,800);
}
function checkDeath(){
  if(playerHP<=0) updateUI("You died.");
  if(dealerHP<=0) updateUI("Dealer died.");
}
function updateUI(msg){
  document.getElementById("status").textContent=msg;
  document.getElementById("hp").textContent=
    `Player HP: ${playerHP} | Dealer HP: ${dealerHP}`;
  renderAll();
}
function renderAll(){
  renderInv(playerInv,"playerInv",true);
  renderInv(dealerInv,"dealerInv",false);
}

/* ===== UTIL ===== */
function randomItem(){ return Object.keys(ITEMS)[r(0,8)]; }
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}
function r(a,b){return Math.floor(Math.random()*(b-a+1))+a}
</script>
</body>
</html>
